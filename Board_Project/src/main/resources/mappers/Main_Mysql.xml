<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gyu.portfolio.service.mapper.MainMapper">
	
	<resultMap id="mainVO" type="mainVO">
		<result property="mainSeq"		column="MAIN_SEQ"	/>
		<result property="mainSe"		column="MAIN_SE" 	/>
		<result property="topBnNm"		column="TOP_BN_NM" 	/>
		<result property="botmBnNm"		column="BOTM_BN_NM" />
		<result property="techNm"		column="TECH_NM" 	/>
		<result property="poforNm"		column="POFOR_NM" 	/>
		<result property="expln"		column="EXPLN" 	  	/>
		
		<result property="regNo"		column="REG_NO" 	/>
		<result property="regDt"		column="REG_DT" 	/>
		<result property="updNo"		column="UPD_NO" 	/>
		<result property="updDt"		column="UPD_DT" 	/>
		<result property="stat"			column="STAT" 		/>
	</resultMap>
	
	<insert id="addMain">
		INSERT INTO TB_MAIN(
			MAIN_SE
			, TOP_BN_NM
			, BOTM_BN_NM
			, TECH_NM
			, POFOR_NM
			, EXPLN
			, REG_NO
			, REG_DT
			, UPD_NO
			, UPD_DT
			, STAT
		)VALUES (
			#{mainSe}
			, #{topBnNm}
			, #{botmBnNm}
			, #{techNm}
			, #{poforNm}
			, #{expln}
			, #{regNo}
			, NOW()
			, #{regNo}
			, NOW()
			, 1
		)
		<selectKey keyProperty="mainSeq" resultType="integer" order="AFTER">
			SELECT LAST_INSERT_ID()
		</selectKey>
	</insert>
	
	<update id="updateMain">
		 UPDATE
		 	TB_MAIN
		 SET
			TOP_BN_NM    = #{topBnNm}
			, BOTM_BN_NM = #{botmBnNm}
			, TECH_NM    = #{techNm}
			, POFOR_NM   = #{poforNm}
			, EXPLN      = #{expln}
			, UPD_NO     = #{updNo}
			, UPD_DT 	 = NOW()
		WHERE 1=1
			AND MAIN_SEQ = #{mainSeq}
	</update>
	
	<select id="getMainList" resultMap="mainVO">
		SELECT
			MAIN_SEQ
			, MAIN_SE
			, TOP_BN_NM
			, BOTM_BN_NM
			, TECH_NM
			, POFOR_NM
			, EXPLN
			, REG_NO
			, REG_DT
			, UPD_NO
			, UPD_DT
			, STAT
		FROM TB_MAIN
		WHERE 1=1
			AND MAIN_SEQ = #{mainSeq}
			AND MAIN_SE = #{mainSe}
	</select>
	
	<select id="getMain" resultMap="mainVO">
		SELECT
			MAIN_SEQ
			, MAIN_SE
			, TOP_BN_NM
			, BOTM_BN_NM
			, TECH_NM
			, POFOR_NM
			, EXPLN
			, REG_NO
			, REG_DT
			, UPD_NO
			, UPD_DT
			, STAT
		FROM TB_MAIN
		WHERE 1=1
			AND MAIN_SE = #{mainSe}
	</select>
	
	<delete id="deleteMain">
		DELETE FROM TB_MAIN
		WHERE 1=1
			AND MAIN_SEQ IN(
		 	<foreach collection="delSeqArr" item="seq" separator=",">
		 		#{seq}
		 	</foreach>
			)
	</delete>
	
</mapper>